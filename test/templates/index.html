<!DOCTYPE html>
<html lang="ko" data-theme="{{ theme }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FocusMate - AI 학습 어시스턴트</title>
    <!-- Bootstrap과 Material Icons 로드 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <!-- 스타일시트 로드 -->
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body class="{{ theme }}-theme" data-logged-in="{{ 'true' if is_logged_in else 'false' }}" data-username="{{ username or '' }}">
    <!-- 헤더 -->
    <header class="app-header">
        <div class="app-title-container">
            <a href="/" class="app-logo">
                <span class="logo-text">FocusMate</span>
                <span class="logo-subtext">AI 학습 어시스턴트</span>
            </a>
        </div>
        <!-- 메뉴 드롭다운 -->
        <div class="header-menu-toggle">
            <button class="menu-toggle-button" id="menuToggle">
                <span class="material-icons">menu</span>
            </button>
            <div class="header-dropdown" id="headerDropdown">
                {% if is_logged_in %}
                    <a href="/auth/logout" class="dropdown-item"><span class="material-icons">logout</span> 로그아웃</a>
                    <div class="dropdown-divider"></div>
                {% else %}
                    <a href="/auth/login" class="dropdown-item"><span class="material-icons">login</span> 로그인</a>
                    <a href="/auth/signup" class="dropdown-item"><span class="material-icons">person_add</span> 회원가입</a>
                    <div class="dropdown-divider"></div>
                {% endif %}
                <a href="/auth/theme" class="dropdown-item">
                    <span class="material-icons">
                        {% if theme == 'dark' %}light_mode{% else %}dark_mode{% endif %}
                    </span> 
                    {% if theme == 'dark' %}라이트 모드{% else %}다크 모드{% endif %}
                </a>
                <a href="/settings" class="dropdown-item"><span class="material-icons">settings</span> 설정</a>
            </div>
        </div>
    </header>

    <!-- 메인 콘텐츠 영역 -->
    <div class="main-container">
        <main class="content">
            <!-- 학습 모니터링 상태 -->
            <div class="status-container">
                <div class="status-indicator">
                    <div class="status-dot"></div>
                    <div class="status-text">학습 모니터링 비활성화</div>
                </div>
                <div class="monitor-timer">00:00:00</div>
            </div>

            <!-- 비디오 컨테이너 -->
            <div class="video-container"></div>

            <!-- 비디오 컨트롤 -->
            <div class="video-controls">
                <button class="control-btn" id="webcamToggle">
                    <span class="material-icons">videocam</span>
                </button>
                <button class="control-btn" id="captureBtn">
                    <span class="material-icons">photo_camera</span>
                </button>
                <button class="control-btn" id="timerToggle">
                    <span class="material-icons">timer</span>
                </button>
                <button class="control-btn" id="downloadBtn">
                    <span class="material-icons">download</span>
                </button>
                <button class="control-btn stop" id="stopBtn">
                    <span class="material-icons">stop</span>
                </button>
            </div>

            <!-- 탭 네비게이션 -->
            <div class="tab-navigation">
                <div class="tab-item" data-tab="analysis">분석 결과</div>
                <div class="tab-item active" data-tab="chat">AI 어시스턴트</div>
                <div class="tab-item" data-tab="history">학습 기록</div>
            </div>

            <!-- 탭 컨텐츠 영역 -->
            <div class="tab-content-wrapper">
                <!-- 채팅 탭 -->
                <div id="chatTab" class="tab-content active">
                    <div class="assistant-container">
                        <!-- 채팅 메시지가 여기에 표시됩니다 -->
                    </div>
                    <div class="chat-input-container">
                        <input type="text" class="chat-input" placeholder="메시지를 입력하세요... (Shift+Enter로 줄바꿈)" />
                        <button class="send-btn">전송</button>
                    </div>
                </div>

                <!-- 분석 결과 탭 -->
                <div id="analysisTab" class="tab-content">
                    <div class="analysis-result">
                        <h5>오늘의 학습 분석</h5>
                        <div class="mt-3">
                            <p><strong>집중도</strong>: 85%</p>
                            <div class="progress mb-3">
                                <div class="progress-bar bg-success" role="progressbar" style="width: 85%" 
                                    aria-valuenow="85" aria-valuemin="0" aria-valuemax="100"></div>
                            </div>
                            <p><strong>감정 상태</strong>: 집중</p>
                            <p><strong>학습 시간</strong>: 01:25:30</p>
                        </div>
                    </div>
                </div>

                <!-- 학습 기록 탭 -->
                <div id="historyTab" class="tab-content">
                    <div class="learning-history">
                        <h5>최근 학습 기록</h5>
                        <div class="mt-3">
                            <div class="d-flex justify-content-between mb-2">
                                <span>2025-05-01</span>
                                <span>1시간 30분</span>
                            </div>
                            <div class="d-flex justify-content-between mb-2">
                                <span>2025-05-02</span>
                                <span>2시간 15분</span>
                            </div>
                            <div class="d-flex justify-content-between mb-2">
                                <span>2025-05-03</span>
                                <span>45분</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- 스크립트 로드 -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='main.js') }}"></script>
</body>
</html>